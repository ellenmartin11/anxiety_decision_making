"0","happyData1 <- happyData1 %>%"
"0","  mutate(Future=case_when(NextIsland==2 & LastIsland==2 ~ ""Positive"","
"0","                   NextIsland==1 & LastIsland==1 ~ ""Negative""))"
"0",""
"0","happiness_gain <- happyData1 %>%"
"0","  filter(Trial == ""Gain"") %>%"
"0","  group_by(userKey, Future) %>%"
"0","  summarise(mean_zHappy = mean(zHappy_filled, na.rm = TRUE), "
"0","            GAD_score = first(gad7_total),"
"0","            PHQ_score = first(phq8_total), .groups = 'drop') %>%"
"0","  na.omit()"
"0",""
"0","happiness_gain_diff <- happiness_gain %>%"
"0","  spread(key = Future, value = mean_zHappy) %>%"
"0","  mutate(happy_diff = Positive - Negative)  "
"0",""
"0",""
"0","cor.test(happiness_gain_diff$happy_diff, happiness_gain_diff$GAD_score, method=""spearman"")"
"2","Warning in cor.test.default(happiness_gain_diff$happy_diff, happiness_gain_diff$GAD_score,  :"
"2","
 "
"2"," Cannot compute exact p-value with ties
"
"1","
"
"1","	Spearman's rank correlation rho"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","happiness_gain_diff$happy_diff and happiness_gain_diff$GAD_score"
"1",""
"1","
"
"1","S = 14797309, p-value = 0.1749"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","rho"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","sample estimates:
"
"1","       rho "
"1","
"
"1","0.06364279 "
"1","
"
"1","
"
"0","cor.test(happiness_gain_diff$happy_diff, happiness_gain_diff$PHQ_score,method=""spearman"")"
"2","Warning in cor.test.default(happiness_gain_diff$happy_diff, happiness_gain_diff$PHQ_score,  :"
"2","
 "
"2"," Cannot compute exact p-value with ties
"
"1","
"
"1","	Spearman's rank correlation rho"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","happiness_gain_diff$happy_diff and happiness_gain_diff$PHQ_score"
"1",""
"1","
"
"1","S = 15436462, p-value = 0.6213"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","rho"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","sample estimates:
"
"1","       rho "
"1","
"
"1","0.02319791 "
"1","
"
"1","
"
"0","# no correlation between GAD or PHQ and the difference in happiness when the future is positive vs negative in gain domain"
"0",""
"0",""
"0","happiness_loss <- happyData1 %>%"
"0","  filter(Trial == ""Loss"") %>%"
"0","  group_by(userKey, Future) %>%"
"0","  summarise(mean_zHappy = mean(zHappy_filled, na.rm = TRUE), "
"0","            GAD_score = first(gad7_total),"
"0","            PHQ_score = first(phq8_total), .groups = 'drop') %>%"
"0","  na.omit()"
"0",""
"0","happiness_loss_diff <- happiness_loss %>%"
"0","  spread(key = Future, value = mean_zHappy) %>%"
"0","  mutate(happy_diff = Positive - Negative)  "
"0",""
"0",""
"0","cor.test(happiness_loss_diff$happy_diff, happiness_loss_diff$GAD_score, method=""spearman"")"
"2","Warning in cor.test.default(happiness_loss_diff$happy_diff, happiness_loss_diff$GAD_score,  :"
"2","
 "
"2"," Cannot compute exact p-value with ties
"
"1","
"
"1","	Spearman's rank correlation rho"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","happiness_loss_diff$happy_diff and happiness_loss_diff$GAD_score"
"1",""
"1","
"
"1","S = 15700314, p-value = 0.8899"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","rho"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","sample estimates:
"
"1","        rho "
"1","
"
"1","0.006501633 "
"1","
"
"1","
"
"0","cor.test(happiness_loss_diff$happy_diff, happiness_loss_diff$PHQ_score, method=""spearman"")"
"2","Warning in cor.test.default(happiness_loss_diff$happy_diff, happiness_loss_diff$PHQ_score,  :"
"2","
 "
"2"," Cannot compute exact p-value with ties
"
"1","
"
"1","	Spearman's rank correlation rho"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","happiness_loss_diff$happy_diff and happiness_loss_diff$PHQ_score"
"1",""
"1","
"
"1","S = 16014809, p-value = 0.7754"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","rho"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","sample estimates:
"
"1","        rho "
"1","
"
"1","-0.01339923 "
"1","
"
"1","
"
"0","# no correlation in loss domain either"
"0",""
"0",""
"0","# plot"
"0","happiness_domains <- happyData1 %>%"
"0","  filter(Trial %in% c(""Gain"", ""Loss"")) %>%"
"0","  group_by(userKey, Trial, Future) %>%"
"0","  summarise(mean_zHappy = mean(zHappy_filled, na.rm = TRUE), .groups = 'drop')"
"0",""
"0","happiness_diff_domains <- happiness_domains %>%"
"0","  spread(key = Future, value = mean_zHappy) %>%"
"0","  mutate(happy_diff = Positive - Negative)  "
"0",""
"0","happiness_summary <- happiness_diff_domains %>%"
"0","  group_by(Trial) %>%"
"0","  summarise(mean_happy_diff = mean(happy_diff, na.rm = TRUE),"
"0","            sem_happy_diff = sd(happy_diff, na.rm = TRUE) / sqrt(n()),"
"0","            .groups = 'drop')"
"0",""
"0","# Step 4: Create the bar plot"
"0","ggplot(happiness_summary, aes(x = Trial, y = mean_happy_diff, fill = Trial)) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"", width = 0.7, color = ""black"") +"
"0","  geom_errorbar(aes(ymin = mean_happy_diff - sem_happy_diff, ymax = mean_happy_diff + sem_happy_diff),"
"0","                width = 0.2, position = position_dodge(0.7)) +"
"0","  geom_hline(yintercept = 0, linetype = ""dotted"", color = ""black"") +  # Add a dotted line at y=0"
"0","  labs("
"0","    title = ""Difference in zHappy between Positive and Negative Future by Domain"","
"0","    x = ""Domain"","
"0","    y = ""Mean zHappy Difference (Positive - Negative)"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  scale_fill_manual(values = c(""Gain"" = ""#FFD700"", ""Loss"" = ""#FF6347"")) +"
"0","  poster_theme"

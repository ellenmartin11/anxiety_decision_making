"0",""
"0","#happinss based on relEV"
"0",""
"0","happyData1_ev <- happyData1 %>%"
"0","  mutate(SafeEV = SafeProb*SafeValue,"
"0","         RiskyEV = RiskyProb*RiskyValue,"
"0","         relEV = RiskyEV/SafeEV)"
"0",""
"0","happyData1_ev <- happyData1 %>%"
"0","  mutate(SafeEV = abs(SafeProb * SafeValue),"
"0","         RiskyEV = abs(RiskyProb * RiskyValue),"
"0","         relEV = case_when("
"0","           RiskyEV >= 2*SafeEV ~ ""very high relEV"","
"0","           RiskyEV > SafeEV ~ ""high relEV"","
"0","           RiskyEV == SafeEV ~ ""equal relEV"","
"0","           RiskyEV < SafeEV ~ ""low relEV"""
"0","         ),"
"0","         relEV = factor(relEV, levels = c(""low relEV"", ""equal relEV"", ""high relEV"",""very high relEV""))) "
"0",""
"0","risky_data <- happyData1_ev %>%"
"0","  group_by(userKey, Trial, relEV) %>%"
"0","  summarise("
"0","    mean_zhappy = mean(zHappy,na.rm=TRUE),"
"0","    .groups = 'drop'"
"0","  )"
"0",""
"0",""
"0","# Calculate the mean percent_risky per participant for each abs(RiskyEV)"
"0","mean_happy_ev_data <- risky_data %>%"
"0","  group_by(userKey, Trial, relEV) %>%"
"0","  summarise(mean_happy = mean(mean_zhappy, na.rm = TRUE),"
"0","            .groups = 'drop')"
"0",""
"0","# Now calculate the average across participants for each abs(RiskyEV), split by Trial"
"0","overall_mean_happy_ev_data <- mean_happy_ev_data %>%"
"0","  group_by(Trial, relEV) %>%"
"0","  summarise(mean_z_happy_all = mean(mean_happy, na.rm = TRUE),"
"0","            sem_z_happy_all = sd(mean_happy, na.rm=TRUE) / sqrt(n()),"
"0","            .groups = 'drop')"
"0",""
"0",""
"0","# Plot the data with error bars"
"0","ggplot(overall_mean_happy_ev_data, aes(x = relEV, y = mean_z_happy_all, color = Trial, group = Trial)) +"
"0","  geom_line(size = 1) +                             # Ensure the line connects the points"
"0","  geom_point() +                                    # Points for clarity"
"0","  geom_errorbar(aes(ymin = mean_z_happy_all - sem_z_happy_all, ymax = mean_z_happy_all + sem_z_happy_all), width = 0.2) +  # Error bars for SEM"
"0","  geom_hline(yintercept = 0, linetype = ""dotted"", color = ""black"") +  # Dotted line at y=0"
"0","  labs(x = ""Relative EV"", y = ""Mean z Happy Score"","
"0","       title = ""Mean z Happy Score by Absolute RiskyEV"","
"0","       color = ""Trial"") +"
"0","  theme_minimal() +"
"0","  scale_color_manual(values = c(""Gain"" = ""#FFD700"", ""Loss"" = ""#FF6347"")) +  # Custom colors"
"0","  poster_theme"
"0",""

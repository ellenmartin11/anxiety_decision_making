"0","## NON-BACKFILLED"
"0","happyData1 <- happyData1 %>%"
"0","  mutate(residuals = zHappy - zHappyPred)"
"0",""
"0","# z-scored happiness with Trial filter"
"0","choice_risky_pos <- happyData1 %>%"
"0","  filter(Choice == 2 & NextIsland == 2 & LastIsland == 2 & (Trial == ""Gain"" | Trial == ""Loss"")) %>%"
"0","  group_by(userKey, Trial) %>%"
"0","  summarise(mean_zhappy = mean(zHappy, na.rm = TRUE),"
"0","            mean_zpredhappy = mean(zHappyPred, na.rm = TRUE),"
"0","              .groups = 'drop') %>%"
"0","  mutate(Choice = ""Risky"","
"0","         Future = ""Positive"")"
"0",""
"0",""
"0","choice_risky_neg <- happyData1 %>%"
"0","  filter(Choice == 2 & NextIsland == 1 & LastIsland == 1 & (Trial == ""Gain"" | Trial == ""Loss"")) %>%"
"0","  group_by(userKey, Trial) %>%"
"0","  summarise(mean_zhappy = mean(zHappy, na.rm = TRUE),"
"0","            mean_zpredhappy = mean(zHappyPred, na.rm = TRUE),"
"0","              .groups = 'drop') %>%"
"0","  mutate(Choice = ""Risky"","
"0","         Future = ""Negative"")"
"0",""
"0","# Safe choice"
"0","choice_safe_pos <- happyData1 %>%"
"0","  filter(Choice == 1 & NextIsland == 2 & LastIsland == 2 & (Trial == ""Gain"" | Trial == ""Loss"")) %>%"
"0","  group_by(userKey, Trial) %>%"
"0","  summarise(mean_zhappy = mean(zHappy, na.rm = TRUE),"
"0","            mean_zpredhappy = mean(zHappyPred, na.rm = TRUE),"
"0","              .groups = 'drop') %>%"
"0","  mutate(Choice = ""Safe"","
"0","         Future = ""Positive"")"
"0",""
"0","choice_safe_neg <- happyData1 %>%"
"0","  filter(Choice == 1 & NextIsland == 1 & LastIsland == 1 & (Trial == ""Gain"" | Trial == ""Loss"")) %>%"
"0","  group_by(userKey, Trial) %>%"
"0","  summarise(mean_zhappy = mean(zHappy, na.rm = TRUE),"
"0","            mean_zpredhappy = mean(zHappyPred, na.rm = TRUE),"
"0","              .groups = 'drop') %>%"
"0","  mutate(Choice = ""Safe"","
"0","         Future = ""Negative"")"
"0",""
"0","# Combine all choices"
"0","choice_combined <- bind_rows(choice_risky_pos, choice_risky_neg, choice_safe_pos, choice_safe_neg)"
"0",""
"0","# Summarise by Choice, Future, and Trial"
"0","summary_choice <- choice_combined %>%"
"0","  group_by(Choice, Future, Trial) %>%"
"0","  summarise(mean_happy = mean(mean_zhappy, na.rm = TRUE),"
"0","            mean_predhappy = mean(mean_zpredhappy, na.rm = TRUE),"
"0","            sem_happy = sd(mean_zhappy, na.rm = TRUE) / sqrt(n()),"
"0","            sem_predhappy = sd(mean_zpredhappy, na.rm = TRUE) / sqrt(n()))"
"1","[38;5;254m`summarise()` has grouped output by 'Choice', 'Future'. You can override using the `.groups` argument.[39m
"
"0","# Plot happiness based on choice, future, and trial"
"0","ggplot(summary_choice, aes(x = Choice, y = mean_happy, fill = Trial)) +"
"0","geom_bar(stat = ""identity"", position = ""dodge"", width = 0.7, color = ""black"") +"
"0","  geom_errorbar(aes(ymin = mean_happy - sem_happy, ymax = mean_happy + sem_happy),"
"0","                position = position_dodge(0.7), width = 0.2) + "
"0","  geom_point(aes(y = mean_predhappy), color = ""lightblue"", shape = 8, size = 3, position = position_dodge(0.7)) +"
"0","  geom_hline(yintercept = 0, linetype = ""dotted"", color = ""black"") +  # Add a dotted line at y=0"
"0","  labs("
"0","    title = ""Happiness (z-scored) Based on Choice and Trial"","
"0","    x = ""Choice"","
"0","    y = ""zHappy"""
"0","  ) +"
"0","  scale_fill_manual(values = c(""Gain"" = ""#FFD700"", ""Loss"" = ""#FF6347"")) + "
"0","  facet_wrap(~Future) +"
"0","  ylim(-0.35,0.35) +"
"0","  theme_minimal() +"
"0","  poster_theme"

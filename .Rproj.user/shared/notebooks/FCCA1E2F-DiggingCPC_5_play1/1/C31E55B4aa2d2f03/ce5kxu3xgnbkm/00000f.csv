"0","sample_size = length(unique(happyData1_past$userKey))"
"0",""
"0","# current gain, past positive, future positive"
"0","current_pos_past_pos_future_pos <- happyData1_past %>%"
"0","  filter(NextIsland == 2, PastIsland == 2, Trial == ""Gain"") %>%"
"0","  group_by(userKey) %>%"
"0","  summarise(mean_zHappy = mean(zHappy, na.rm=TRUE),"
"0","              .groups = 'drop') %>%"
"0","  mutate(Past = ""Positive Past"","
"0","         Future = ""Positive Future"","
"0","         Current = ""Gain"")"
"0",""
"0","# current gain, past negative, future negative"
"0","current_pos_past_neg_future_neg <- happyData1_past %>%"
"0","  filter(NextIsland == 1, PastIsland == 1, Trial == ""Gain"") %>%"
"0","  group_by(userKey) %>%"
"0","  summarise(mean_zHappy = mean(zHappy, na.rm=TRUE),"
"0","              .groups = 'drop') %>%"
"0","  mutate(Past  = ""Negative Past"","
"0","         Future = ""Negative Future"","
"0","         Current = ""Gain"")"
"0","  "
"0","# current loss, past positive, future positive"
"0","current_neg_past_pos_future_pos <- happyData1_past %>%"
"0","  filter(NextIsland == 2, PastIsland == 2 , Trial == ""Loss"") %>%"
"0","  group_by(userKey) %>%"
"0","  summarise(mean_zHappy = mean(zHappy, na.rm=TRUE),"
"0","              .groups = 'drop') %>%"
"0","  mutate(Past= ""Positive Past"","
"0","         Future=""Positive Future"","
"0","         Current = ""Loss"")"
"0",""
"0",""
"0","# current loss, past negative, future negative"
"0","current_neg_past_neg_future_neg <- happyData1_past %>%"
"0","  filter(NextIsland == 1, PastIsland == 1, Trial == ""Loss"") %>%"
"0","  group_by(userKey) %>%"
"0","  summarise(mean_zHappy = mean(zHappy, na.rm=TRUE),"
"0","              .groups = 'drop') %>%"
"0","  mutate(Past = ""Negative Past"","
"0","         Future = ""Negative Future"","
"0","         Current = ""Loss"")"
"0",""
"0","# current gain, past negative, future positive"
"0","current_pos_past_neg_future_pos <- happyData1_past %>%"
"0","  filter(NextIsland == 2, PastIsland == 1, Trial == ""Gain"") %>%"
"0","  group_by(userKey) %>%"
"0","  summarise(mean_zHappy = mean(zHappy, na.rm=TRUE),"
"0","              .groups = 'drop') %>%"
"0","  mutate(Past = ""Negative Past"","
"0","         Future = ""Positive Future"","
"0","         Current = ""Gain"")"
"0",""
"0","# current gain, past positive, future negative"
"0","current_pos_past_pos_future_neg <- happyData1_past %>%"
"0","  filter(NextIsland == 1, PastIsland == 2, Trial == ""Gain"") %>%"
"0","  group_by(userKey) %>%"
"0","  summarise(mean_zHappy = mean(zHappy, na.rm=TRUE),"
"0","              .groups = 'drop') %>%"
"0","  mutate(Past = ""Positive Past"","
"0","         Future = ""Negative Future"","
"0","         Current = ""Gain"")"
"0","  "
"0","# current loss, past negative, future positive"
"0","current_neg_past_neg_future_pos <- happyData1_past %>%"
"0","  filter(NextIsland == 2, PastIsland == 1 , Trial == ""Loss"") %>%"
"0","  group_by(userKey) %>%"
"0","  summarise(mean_zHappy = mean(zHappy, na.rm=TRUE),"
"0","              .groups = 'drop') %>%"
"0","  mutate(Past = ""Negative Past"","
"0","         Future = ""Positive Future"","
"0","         Current = ""Loss"")"
"0",""
"0",""
"0","# current loss, past positive, future negative"
"0","current_neg_past_pos_future_neg <- happyData1_past %>%"
"0","  filter(NextIsland == 1, PastIsland == 2, Trial == ""Loss"") %>%"
"0","  group_by(userKey) %>%"
"0","  summarise(mean_zHappy = mean(zHappy, na.rm=TRUE),"
"0","              .groups = 'drop') %>%"
"0","  mutate(Past = ""Positive Past"","
"0","         Future = ""Negative Future"","
"0","         Current = ""Loss"")"
"0","  "
"0","  # Combine results"
"0","combined_happy <- bind_rows(current_pos_past_neg_future_pos, current_pos_past_pos_future_neg, current_neg_past_neg_future_pos,current_neg_past_pos_future_neg,current_pos_past_pos_future_pos,current_pos_past_neg_future_neg,current_neg_past_pos_future_pos,current_neg_past_neg_future_neg)"
"0",""
"0","summary_combined <- combined_happy %>%"
"0","  group_by(Current, Past, Future) %>%"
"0","  summarise(overall_mean_zHappy = mean(mean_zHappy,na.rm=TRUE),"
"0","            sem_zHappy = sd(mean_zHappy, na.rm = TRUE) / sqrt(n()))"
"2","`summarise()` has grouped output by 'Current', 'Past'. You can override using the `.groups` argument."
"0","  # Plotting"
"0","  ggplot(summary_combined, aes(x = Past, y = overall_mean_zHappy, fill = Future, group = Future)) +"
"0","    geom_bar(stat = ""identity"", position = position_dodge(0.7), width = 0.7, color = ""black"") +"
"0","    geom_line(position = position_dodge(0.7), aes(group = Future)) +  # Add lines connecting points within groups"
"0","    geom_errorbar(aes(ymin = overall_mean_zHappy - sem_zHappy, ymax = overall_mean_zHappy + sem_zHappy),"
"0","                  position = position_dodge(0.7), width = 0.2) + "
"0","    geom_hline(yintercept =0, linetype = ""dotted"", color = ""black"") +  # Add a dotted line at y=0"
"0","    labs("
"0","title = paste0(""zHappy based on Past and Future (N="", sample_size, "")""),"
"0","      x = ""Past"","
"0","      y = ""zHappy"""
"0","    ) +"
"0","    theme_minimal() +"
"0","    ylim(-0.4,0.4)+"
"0","    poster_theme +"
"0","    facet_wrap(~Current)"
